@(params: GameViewParams)

@main("Minesweeper") {
	<style>
		:root {
			--grid-width: @params.width;
			--grid-height: @params.height;
		}

		#grid-container {
			display: grid;
			grid-template-columns: repeat(var(--grid-width), 32px);
			grid-template-rows: repeat(var(--grid-height), 32px);
			padding: 1rem;
			background-color: var(--dark-color);
			border-radius: 1rem;
		}

		.cell:hover {
			filter: brightness(120%);
		}
	</style>
	<script>
		const imageBasePath = "@routes.Assets.versioned("images/")";
		console.log(imageBasePath);
	</script>
    <script defer src="@routes.Assets.versioned("javascripts/game.js")" type="text/javascript"></script>
	<div class="d-flex flex-column align-items-center">
		<div class="d-flex flex-row align-items-center gap-4">
			<h2>Time: <span id="time">@params.elapsed</span>s</h2>
			<h2>Undos: <span id="undos">@params.undos</span></h2>
		</div>
		<div id="grid-container">
			@for((x, y, cell) <- params.cells) {
				@if(cell.isRevealed){
					@if(cell.isBomb) {
						<img
							src="@routes.Assets.versioned("images/bomb.png")"
							alt="cell"
							width="32px" height="32px"
							class="cell bomb"
							x="@x" y="@y"
						>
					} else if (cell.nearbyBombs == 0) {
						<img
							src="@routes.Assets.versioned("images/revealed.png")"
							alt="cell"
							width="32px" height="32px"
							class="cell revealed"
							x="@x" y="@y"
						>
					} else {
						<img
							src="@routes.Assets.versioned("images/" + cell.nearbyBombs.toString + ".png")"
							alt="cell"
							width="32px" height="32px"
							class="cell revealed-@cell.nearbyBombs.toString"
							x="@x" y="@y"
						>
					}
				} else if (cell.isFlagged) {
					<img
						src="@routes.Assets.versioned("images/flagged.png")"
						alt="cell"
						width="32px" height="32px"
						class="cell flagged"
						x="@x" y="@y"
						onclick="reveal(this)"
					>
				} else {
					<img
						src="@routes.Assets.versioned("images/unrevealed.png")"
						alt="cell"
						width="32px" height="32px"
						class="cell unrevealed"
						x="@x" y="@y"
						onclick="reveal(this)"
						oncontextmenu="flag(this)"
					>
				}
			}
		</div>
		<div class="d-flex flex-row justify-content-between align-items-center mt-4 w-50 gap-2">
			<button class="btn w-100 text-nowrap" onclick="main_menu()">Main Menu</button>
			<button class="btn w-100 text-nowrap" onclick="undo()">Undo</button>
			<button class="btn w-100 text-nowrap" onclick="redo()">Redo</button>
		</div>
	</div>
}
