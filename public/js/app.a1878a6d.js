(function(){"use strict";var e={6658:function(e,n,t){var o=t(5130),r=t(1387),s=t(6768);const a={id:"header-title"};function l(e,n,t,o,r,l){const i=(0,s.g2)("router-link"),u=(0,s.g2)("RouterView");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("header",null,[(0,s.Lk)("div",a,[(0,s.bF)(i,{to:"/"},{default:(0,s.k6)((()=>n[0]||(n[0]=[(0,s.Lk)("img",{id:"logo",src:"/images/logo.png",alt:"minesweeper logo",width:"32px",height:"32px",title:"go back"},null,-1)]))),_:1}),n[1]||(n[1]=(0,s.Lk)("h1",null,"Minesweeper",-1))]),n[2]||(n[2]=(0,s.Lk)("div",null,[(0,s.Lk)("a",{href:"https://github.com/bafto/minesweeper-web",target:"_blank"},[(0,s.Lk)("img",{invert:"",src:"/images/github.svg",alt:"github logo",width:"32px",height:"32px",title:"Github"})])],-1))]),(0,s.Lk)("main",null,[(0,s.bF)(u)]),(0,s.Lk)("footer",null,[(0,s.bF)(i,{to:"/about"},{default:(0,s.k6)((()=>n[3]||(n[3]=[(0,s.eW)("Über Minesweeper")]))),_:1})])],64)}var i={name:"App",data(){return{lobbies:[],username:"",width:10,height:10,bomb_chance:.5,max_undos:3,socket:null}}},u=t(1241);const d=(0,u.A)(i,[["render",l]]);var c=d;const p={id:"mode-select"},b=["v-if"];function h(e,n,t,o,r,a){const l=(0,s.g2)("RouterLink");return(0,s.uX)(),(0,s.CE)("div",p,[n[3]||(n[3]=(0,s.Lk)("h1",null,"Select a game mode",-1)),(0,s.Lk)("h1",{"v-if":!e.navigator.onLine},"Offline!",8,b),(0,s.bF)(l,{to:"/start-singleplayer",class:"btn"},{default:(0,s.k6)((()=>n[0]||(n[0]=[(0,s.eW)("Play Singleplayer")]))),_:1}),(0,s.bF)(l,{to:"/create-lobby",class:"btn"},{default:(0,s.k6)((()=>n[1]||(n[1]=[(0,s.eW)("Create Multiplayer Lobby")]))),_:1}),(0,s.bF)(l,{to:"/join-lobby",class:"btn"},{default:(0,s.k6)((()=>n[2]||(n[2]=[(0,s.eW)("Join Multiplayer Lobby")]))),_:1})])}var m={name:"SelectGamemodePage"};const g=(0,u.A)(m,[["render",h],["__scopeId","data-v-64348b14"]]);var y=g;const f={id:"lobby-list"},k={id:"opts"},v={id:"cards"},w={key:0};function L(e,n,t,r,a,l){const i=(0,s.g2)("LobbyCard"),u=(0,s.g2)("RouterLink");return(0,s.uX)(),(0,s.CE)("div",f,[n[4]||(n[4]=(0,s.Lk)("h1",null,"Lobbies",-1)),(0,s.Lk)("div",k,[n[2]||(n[2]=(0,s.Lk)("label",null,"Join as: ",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>a.username=e),required:""},null,512),[[o.Jo,a.username]]),(0,s.Lk)("button",{onClick:n[1]||(n[1]=(...e)=>l.updateLobbies&&l.updateLobbies(...e))},"Refresh List")]),(0,s.Lk)("div",v,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.lobbies,(e=>((0,s.uX)(),(0,s.Wv)(i,{key:e.username,lobby:e,username:a.username},null,8,["lobby","username"])))),128)),a.lobbies&&0!==a.lobbies.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("p",w,"No lobbies found"))]),(0,s.bF)(u,{to:"/",class:"btn"},{default:(0,s.k6)((()=>n[3]||(n[3]=[(0,s.eW)("Go back")]))),_:1})])}var C=t(4232);const _={class:"lobby-card"},x=["disabled"];function S(e,n,t,o,r,a){return(0,s.uX)(),(0,s.CE)("div",_,[(0,s.Lk)("span",null,(0,C.v_)(this.lobby.name)+"'s Lobby",1),(0,s.Lk)("span",null,(0,C.v_)(this.lobby.players.length)+" Players",1),(0,s.Lk)("button",{onClick:n[0]||(n[0]=e=>a.joinLobby()),disabled:!t.username},"Join",8,x)])}t(4114);class E{Connect(e){return this.socket&&this.socket.close(),this.socket=new WebSocket(e),this.socket}Get(){return this.socket}}const O=new E;var F=O,J={name:"LobbyCard",props:{lobby:{type:Object,required:!0},username:{type:String,required:!0}},methods:{joinLobby(){if(F.Get())return;const e=F.Connect(`ws://localhost:9000/api/ws/multiplayer?username=${this.username}&lobby=${this.lobby.name}`);e.onopen=()=>{console.log("ws open")},e.onclose=()=>console.log("ws close"),e.onerror=()=>console.error("ws error"),e.onmessage=e=>M(e,this)}}};function M(e,n){const t=JSON.parse(e.data);switch(t.type){case"status":console.log(t.message);break;case"setup":console.log("setup",t.players),n.$router.push({path:"/multiplayer",query:{players:t.players,username:n.username}});break;case"error":console.error(t.message)}}const X=(0,u.A)(J,[["render",S],["__scopeId","data-v-cb3a53b2"]]);var N=X,P={name:"JoinLobbyPage",components:{LobbyCard:N},data(){return{username:"",lobbies:[]}},mounted(){this.updateLobbies()},methods:{async updateLobbies(){this.lobbies=await fetch("/api/lobbies").then((e=>e.json())).catch((e=>console.error("Error fetching lobbies: ",e)))}}};const G=(0,u.A)(P,[["render",L],["__scopeId","data-v-61e37710"]]);var I=G;const j={key:0,id:"waiting-overlay"},A={id:"settings-inputs"},q={key:0},W={id:"range-wrapper"},B=["invalid"],T={id:"settings-buttons"},$=["disabled"];function U(e,n,t,r,a,l){const i=(0,s.g2)("RouterLink");return(0,s.uX)(),(0,s.CE)(s.FK,null,[t.multiplayer&&a.waiting?((0,s.uX)(),(0,s.CE)("div",j,n[8]||(n[8]=[(0,s.Lk)("h1",null,"Waiting for player...",-1)]))):(0,s.Q3)("",!0),(0,s.Lk)("form",{id:"settings",onSubmit:n[7]||(n[7]=(0,o.D$)((()=>{}),["prevent"]))},[n[15]||(n[15]=(0,s.Lk)("h2",null,"Board Settings",-1)),(0,s.Lk)("div",A,[t.multiplayer?((0,s.uX)(),(0,s.CE)("label",q,"Username:")):(0,s.Q3)("",!0),t.multiplayer?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:1,"onUpdate:modelValue":n[0]||(n[0]=e=>a.username=e),type:"text",required:""},null,512)),[[o.Jo,a.username]]):(0,s.Q3)("",!0),n[9]||(n[9]=(0,s.Lk)("label",null,"Board Width:",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>a.width=e),type:"number",required:"",min:"1",max:"32"},null,512),[[o.Jo,a.width]]),n[10]||(n[10]=(0,s.Lk)("label",null,"Board Height:",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":n[2]||(n[2]=e=>a.height=e),type:"number",required:"",min:"1",max:"32"},null,512),[[o.Jo,a.height]]),n[11]||(n[11]=(0,s.Lk)("label",null,"Bomb Chance:",-1)),(0,s.Lk)("div",W,[(0,s.bo)((0,s.Lk)("input",{type:"range","onUpdate:modelValue":n[3]||(n[3]=e=>a.bomb_chance=e),required:"",step:"0.01",min:"0",max:"1"},null,512),[[o.Jo,a.bomb_chance]]),(0,s.Lk)("output",null,(0,C.v_)((100*a.bomb_chance).toFixed(0))+"%",1)]),n[12]||(n[12]=(0,s.Lk)("label",null,"Max Undos:",-1)),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":n[4]||(n[4]=e=>a.max_undos=e),invalid:""===a.max_undos,required:"",min:"0",max:"10"},null,8,B),[[o.Jo,a.max_undos]])]),(0,s.Lk)("div",T,[(0,s.bF)(i,{to:"/",class:"btn"},{default:(0,s.k6)((()=>n[13]||(n[13]=[(0,s.eW)("Go back")]))),_:1}),t.multiplayer?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(i,{key:0,to:"/singleplayer",onClick:n[5]||(n[5]=e=>l.startGame()),disabled:l.disableButtons,class:"btn"},{default:(0,s.k6)((()=>n[14]||(n[14]=[(0,s.eW)("Start Singleplayer")]))),_:1},8,["disabled"])),t.multiplayer&&!a.waiting?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:n[6]||(n[6]=e=>l.selectMultiplayer()),disabled:l.disableButtons,class:"btn"},"Create Lobby",8,$)):(0,s.Q3)("",!0)])],32)],64)}var R={name:"SettingsComponent",props:{multiplayer:Boolean},data(){return{waiting:!1,username:"dummy",width:10,height:10,bomb_chance:.5,max_undos:3}},computed:{disableButtons(){return!(this.width&&this.height&&this.max_undos&&this.username.trim())}},methods:{startGame(){fetch("/api/start_game",{method:"POST",headers:{"Content-Type":"application/json","Csrf-Token":D("play-csrf-token")},body:JSON.stringify({width:this.width,height:this.height,bomb_chance:parseFloat(this.bomb_chance),max_undos:this.max_undos})}).catch(console.error)},async selectMultiplayer(){fetch("/api/select_multiplayer",{method:"POST",headers:{"Content-Type":"application/json","Csrf-Token":D("play-csrf-token")},body:JSON.stringify({username:this.username,width:this.width,height:this.height,bomb_chance:parseFloat(this.bomb_chance),max_undos:this.max_undos})}).then((async e=>{const n=await e.json();n.error?console.error(n.error):Q(this.username,this)})).catch(console.error)}}};function D(e){const n=document.cookie.split(";");for(let t of n)if(t=t.trim(),t.startsWith(e+"="))return t.substring(e.length+1);return null}function Q(e,n){const t=F.Connect(`ws://localhost:9000/api/ws/multiplayer?username=${e}&lobby=${e}`);return t.onopen=()=>{console.log("ws open"),n.waiting=!0},t.onclose=()=>console.log("ws close"),t.onerror=()=>console.error("ws error"),t.onmessage=e=>K(e,n),t}async function V(e){fetch("/api/start_multiplayer",{method:"POST",body:JSON.stringify({lobby:e}),headers:{"Content-Type":"application/json","Csrf-Token":D("play-csrf-token")}}).then((()=>console.log("started"))).catch(console.error)}function K(e,n){const t=JSON.parse(e.data);switch(t.type){case"status":console.log(t.message),V(n.username);break;case"won/lost":console.log("won/lost");break;case"update":console.log("update"),console.log(t);break;case"setup":console.log("setup",t.players),n.$router.push({path:"/multiplayer",query:{players:t.players,username:n.username}});break;case"error":console.error(t.message)}}const z=(0,u.A)(R,[["render",U],["__scopeId","data-v-5135e801"]]);var Z=z;function H(e,n,t,o,r,a){return(0,s.uX)(),(0,s.CE)(s.FK,null,[n[0]||(n[0]=(0,s.Lk)("h1",null,"Über Minesweeper",-1)),n[1]||(n[1]=(0,s.Lk)("h2",null,"Das Spiel",-1)),n[2]||(n[2]=(0,s.Lk)("p",null,"Minesweeper ist ein Logikspiel, bei dem das Ziel darin besteht, alle Felder eines Rasters aufzudecken, die keine Minen enthalten. Der Spieler klickt auf Felder, und wenn eine Mine getroffen wird, verliert man das Spiel. Wenn kein Mine getroffen wird, zeigt das Feld eine Zahl, die anzeigt, wie viele Minen sich in den angrenzenden Feldern befinden.",-1)),n[3]||(n[3]=(0,s.Lk)("p",null,"Durch logisches Denken kann der Spieler ableiten, wo sich Minen befinden und diese markieren. Das Spiel ist gewonnen, wenn alle Felder ohne Minen aufgedeckt sind.",-1)),n[4]||(n[4]=(0,s.Lk)("h2",null,"Geschichte",-1)),n[5]||(n[5]=(0,s.Lk)("p",null,"Minesweeper hat seine Ursprünge in den frühen 1960er Jahren und wurde in verschiedenen Formen auf mehreren Plattformen entwickelt. Die bekannteste Version wurde 1990 von Microsoft veröffentlicht und war Teil des Windows-Betriebssystems. Es wurde schnell zu einem der bekanntesten und meistgespielten Computerspiele weltweit.",-1))],64)}var Y={name:"AboutPage"};const ee=(0,u.A)(Y,[["render",H]]);var ne=ee;const te={id:"game"},oe={id:"stat-container"},re={id:"grids-container"},se={key:0,id:"end-overlay"},ae={id:"button-container"},le=["disabled"],ie=["disabled"];function ue(e,n,t,o,r,a){const l=(0,s.g2)("GameComponent");return(0,s.uX)(),(0,s.CE)("div",te,[(0,s.Lk)("div",oe,[(0,s.Lk)("h2",null,"Time: "+(0,C.v_)(r.elapsed)+"s",1),(0,s.Lk)("h2",null,"Undos: "+(0,C.v_)(r.undos),1)]),(0,s.Lk)("div",re,[r.end?((0,s.uX)(),(0,s.CE)("div",se,[(0,s.Lk)("h1",null,"You "+(0,C.v_)(r.end)+"!",1),(0,s.Lk)("button",{onClick:n[0]||(n[0]=e=>a.retry())},"Retry")])):(0,s.Q3)("",!0),(0,s.bF)(l,{ref:"game_grid",inputEnabled:!0},null,512)]),(0,s.Lk)("div",ae,[(0,s.Lk)("button",{onClick:n[1]||(n[1]=e=>a.main_menu())},"Main Menu"),(0,s.Lk)("button",{disabled:r.end||0===r.undos,onClick:n[2]||(n[2]=e=>a.undo())},"Undo",8,le),(0,s.Lk)("button",{disabled:r.end,onClick:n[3]||(n[3]=e=>a.redo())},"Redo",8,ie)])])}const de={class:"game-grid"},ce=["cell-x","cell-y"];function pe(e,n,t,r,a,l){return(0,s.uX)(),(0,s.CE)("div",de,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.cells,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.x+e.y,class:(0,C.C4)(["cell",l.getCellImgClass(e.cell)]),alt:"cell",width:"32px",height:"32px","cell-x":e.x,"cell-y":e.y,onClick:n[0]||(n[0]=e=>l.reveal(e)),onContextmenu:n[1]||(n[1]=(0,o.D$)((e=>l.flag(e)),["prevent"]))},null,42,ce)))),128))])}var be={name:"GameComponent",props:{inputEnabled:Boolean},data(){return{cells:[]}},methods:{reveal(e){if(!this.inputEnabled)return;const n=he(e.target);F.Get().send(JSON.stringify({type:"reveal",data:{x:Number.parseInt(n.x),y:Number.parseInt(n.y)}}))},flag(e){if(!this.inputEnabled)return;const n=he(e.target);return F.Get().send(JSON.stringify({type:"flag",data:{x:Number.parseInt(n.x),y:Number.parseInt(n.y)}})),!1},getCellImgClass(e){return e.isRevealed?e.isBomb?"bomb":0===e.nearbyBombs?"revealed":`revealed-${e.nearbyBombs}`:e.isFlagged?"flagged":"unrevealed"}}};function he(e){return{x:e.getAttribute("cell-x"),y:e.getAttribute("cell-y")}}const me=(0,u.A)(be,[["render",pe],["__scopeId","data-v-608b7900"]]);var ge=me,ye={name:"SingleplayerPage",components:{GameComponent:ge},data(){return{elapsed:0,undos:0,end:void 0}},created(){let e=this;const n=F.Connect("ws://localhost:9000/api/ws/singleplayer");n.onopen=()=>{console.log("ws open"),n.send(JSON.stringify({type:"open"}))},n.onclose=()=>console.log("ws close"),n.onerror=()=>console.error("ws error"),n.onmessage=n=>ke(n,e)},methods:{main_menu(){fetch("/api/restart"),this.$router.push({path:"/"})},retry(){const e=this;fetch("/api/retry").then((()=>{e.end=void 0}))},undo(){F.Get().send(JSON.stringify({type:"undo"}))},redo(){F.Get().send(JSON.stringify({type:"redo"}))}}};async function fe(e,n,t){if(0===n.$refs[t].cells.length){const t=document.querySelector(":root");t.style.setProperty("--grid-width",e.width),t.style.setProperty("--grid-height",e.height),setInterval((()=>{n.end||(n.elapsed=n.elapsed+1)}),1e3)}n.$refs[t].cells=e.cells,n.elapsed=e.timer,n.undos=e.undos}function ke(e,n){const t=JSON.parse(e.data);t.end?n.end=t.end:t.reload||fe(t,n,"game_grid")}const ve=(0,u.A)(ye,[["render",ue],["__scopeId","data-v-77665fa5"]]);var we=ve;const Le={id:"game"},Ce={id:"stat-container"},_e={id:"grids-container"},xe={key:0,id:"end-overlay"},Se={id:"button-container"},Ee=["disabled"],Oe=["disabled"];function Fe(e,n,t,o,r,a){const l=(0,s.g2)("GameComponent");return(0,s.uX)(),(0,s.CE)("div",Le,[(0,s.Lk)("div",Ce,[(0,s.Lk)("h2",null,"Time: "+(0,C.v_)(r.elapsed)+"s",1),(0,s.Lk)("h2",null,"Undos: "+(0,C.v_)(r.undos),1)]),(0,s.Lk)("div",_e,[r.end?((0,s.uX)(),(0,s.CE)("div",xe,[(0,s.Lk)("h1",null,(0,C.v_)(r.endPlayer)+" "+(0,C.v_)(r.end)+"!",1),(0,s.Lk)("button",{onClick:n[0]||(n[0]=e=>a.retry())},"Retry")])):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.players,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e},[(0,s.bF)(l,{ref_for:!0,ref:e,inputEnabled:e===t.username},null,8,["inputEnabled"])])))),128))]),(0,s.Lk)("div",Se,[(0,s.Lk)("button",{onClick:n[1]||(n[1]=e=>a.main_menu())},"Main Menu"),(0,s.Lk)("button",{disabled:r.end||0===r.undos,onClick:n[2]||(n[2]=e=>a.undo())},"Undo",8,Ee),(0,s.Lk)("button",{disabled:r.end,onClick:n[3]||(n[3]=e=>a.redo())},"Redo",8,Oe)])])}var Je={name:"MultiplayerPage",components:{GameComponent:ge},props:{username:String,players:Array},data(){return{elapsed:0,undos:0,end:void 0,endPlayer:void 0}},created(){let e=this;F.Get().onmessage=n=>Xe(n,e),setInterval((()=>{e.end||(e.elapsed=e.elapsed+1)}),1e3)},methods:{main_menu(){fetch("/api/restart")},retry(){},undo(){F.Get().send(JSON.stringify({type:"undo"}))},redo(){F.Get().send(JSON.stringify({type:"redo"}))}}};async function Me(e,n,t){if(0===n.$refs[t][0].cells.length){const t=document.querySelector(":root").style;t.setProperty("--player-count",n.players.length),t.setProperty("--grid-width",e.width),t.setProperty("--grid-height",e.height)}n.$refs[t][0].cells=e.cells,n.elapsed=e.timer,n.undos=e.undos}function Xe(e,n){const t=JSON.parse(e.data);switch(t.type){case"status":console.log(t.message);break;case"lost":n.endPlayer=t.username,n.end="lost";break;case"won":n.endPlayer=t.username,n.end="won";break;case"update":if(t.reload)return void Ne();if(t.end)return void(n.end=t.end);Me(t,n,t.username);break;case"error":console.error(t.message)}}function Ne(){window.location.reload()}const Pe=(0,u.A)(Je,[["render",Fe],["__scopeId","data-v-60c7d74a"]]);var Ge=Pe,Ie=t(4458);(0,Ie.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});const je=[{path:"/",component:y},{path:"/about",component:ne},{path:"/start-singleplayer",component:Z},{path:"/create-lobby",component:Z,props:{multiplayer:!0}},{path:"/singleplayer",component:we},{path:"/join-lobby",component:I},{path:"/multiplayer",component:Ge,props:e=>({players:e.query.players,username:e.query.username})}],Ae=(0,r.aE)({history:(0,r.sC)(),routes:je});(0,o.Ef)(c).use(Ae).mount("#app")}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var s=n[o]={exports:{}};return e[o].call(s.exports,s,s.exports,t),s.exports}t.m=e,function(){var e=[];t.O=function(n,o,r,s){if(!o){var a=1/0;for(d=0;d<e.length;d++){o=e[d][0],r=e[d][1],s=e[d][2];for(var l=!0,i=0;i<o.length;i++)(!1&s||a>=s)&&Object.keys(t.O).every((function(e){return t.O[e](o[i])}))?o.splice(i--,1):(l=!1,s<a&&(a=s));if(l){e.splice(d--,1);var u=r();void 0!==u&&(n=u)}}return n}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[o,r,s]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var r,s,a=o[0],l=o[1],i=o[2],u=0;if(a.some((function(n){return 0!==e[n]}))){for(r in l)t.o(l,r)&&(t.m[r]=l[r]);if(i)var d=i(t)}for(n&&n(o);u<a.length;u++)s=a[u],t.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return t.O(d)},o=self["webpackChunkminesweeper_vue"]=self["webpackChunkminesweeper_vue"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(6658)}));o=t.O(o)})();
//# sourceMappingURL=app.a1878a6d.js.map